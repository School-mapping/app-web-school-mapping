<!DOCTYPE html>
<html lang="pt-br">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script
    src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-annotation/2.2.1/chartjs-plugin-annotation.min.js"></script>
<link rel="stylesheet" href="../css/dash.css" />
<link rel="stylesheet" href="../css/dashPorEscola.css" />

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dash especÃ­fica</title>
</head>

<body onload="carregarNome()">
    <aside class="barraLateral-esquerda">
        <img src="../assets/user.png" alt="" class="iconepessoa" />
        <div class="conteudo-central">

            <span id="nomeUser"></span>

            <nav class="menu-lateral">
                <a href="./dash.html" class="btn-menu">Home</a>
                <a href="./escolas.HTML" class="btn-menu">Escolas</a>
                <a href="./configuracao.html" class="btn-menu">ConfiguraÃ§Ã£o</a>
            </nav><ss="sair-section">
                <a href="#" class="btn-menu">Sair</a><!-- Adicionr funÃ§Ã£o de encerramento de seÃ§Ã£o -->

        </div>
    </aside>

    <Main class="conteudo">
        <div class="classHitorico">
            <div class="">VisÃ£o Geral Municipal (IDEB) > Escolas > E.M. Jeremias Jubileu</div>
            <button id="buttonCompararEscola">Comparar com melhor escola do ranking</button>
        </div>

        <div class="classKpis" id="divKpis">

            <div class="classKpi classKpi1">
                <div class="kpi-title">IDEB atual</div>
                <div class="kpi-value">
                    <span id="ideb-atual">7,8 / 10,0 </span>
                    <a class="variacao1">(-1ðŸ”»)</a>
                    <span class="kpi-ref-ano" id="ano-atual">(2025)</span>
                </div>
                <div class="kpi-subtitle">ðŸŽ¯Meta: <span id="">7,0</span></div>

            </div>

            <div class="classKpi classKpi2">
                <div class="kpi-title">Repasse Financeiro - PTRF (R$)</div>
                <div class="kpi-value">
                    <span id="ideb-atual">R$ 300k</span>
                    <a class="variacao2">(+R$50kðŸ”¼)</a>
                </div>
                <div class="kpi-subtitle">Ano: <span>2025</span></div>
            </div>

            <div class="classKpi classKpi3">
                <div class="kpi-title">Ranking de melhores escolas (IDEB)</div>
                <div class="kpi-value">
                    <span id="ideb-atual">48Âº Lugar</span>
                    <a class="variacao3">(+3ðŸ”¼)</a>
                </div>
                <div class="kpi-subtitle">Ano: <span>2025</span></div>
            </div>
        </div>

        <div class="classGraficoPrincipal">
            <canvas id="canvasGraficoPrincipal"></canvas>
        </div>

    </Main>

</body>

</html>
<script>

    function carregarNome() {
        nomeUser.innerHTML = sessionStorage.USUARIO;
    }

    const ctx = document.getElementById('canvasGraficoPrincipal');

    const mixedChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: ['2023', '2025'],
            datasets: [
                {
                    type: 'line',
                    label: 'Repasses Financeiros',
                    data: [250000, 300000],
                    yAxisID: 'RightY', // eixo da direita
                    borderColor: '#85BB65',
                    backgroundColor: '#85BB65',
                    tension: 0.3,
                    borderWidth: 4,
                    borderRadius: 6,
                    borderSkipped: false,
                },
                {
                    type: 'bar',
                    label: 'IDEB',
                    data: [8.8, 7.8],
                    yAxisID: 'LeftY', // eixo da esquerda
                    backgroundColor: '#4600C2',
                    borderColor: '#4600C2',
                    borderWidth: 1,
                    borderRadius: 6,
                    borderSkipped: false,
                }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                title: { display: true, text: 'IDEB e Repasses Financeiros (R$) no decorrer dos anos' },
                legend: { display: true },
                tooltip: { mode: 'index', intersect: false },
                annotation: {
                    annotations: {
                        linhaMeta: {
                            type: 'line',
                            yMin: 7.0,
                            yMax: 7.0,
                            borderColor: '#d9534f',
                            borderWidth: 3,
                            borderDash: [10, 5], // Deixa a linha tracejada (10px traÃ§o, 5px espaÃ§o)
                            label: {
                                enabled: true,
                                content: 'Meta: 7,0',
                                position: 'end',
                                backgroundColor: 'rgba(217, 83, 79, 0.8)',
                                font: {
                                    weight: 'bold'
                                }
                            }
                        }
                    }
                }
            },
            scales: {
                LeftY: {
                    type: 'linear',
                    position: 'left',
                    beginAtZero: true,
                    title: {
                        display: true,
                        text: 'Escala do IDEB'
                    }
                },
                RightY: {
                    type: 'linear',
                    position: 'right',
                    beginAtZero: true,
                    title: {
                        display: true,
                        text: 'Repasses financeiros - PTRF'
                    },
                    grid: {
                        drawOnChartArea: false
                    }
                }
            }
        }
    });


</script>